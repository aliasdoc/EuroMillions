language: php
php:
  - '5.3.3'
  - '5.3'
  - '5.4'
  - '5.5'
  - '5.6'
  - '7.0'

allow_failures:
  - php: '5.3.3'

before_script:
  - cd php/
  - travis_retry composer self-update && composer --version
  - if [[ ${TRAVIS_PHP_VERSION:0:3} == "5.3.3" ]]; then composer config -g -- disable-tls true; fi
  - travis_retry composer install -n
  - cp app/config/parameters.yml.dist app/config/parameters.yml
  - php app/console doctrine:database:create --env=test
  - php app/console doctrine:schema:create --env=test
  - php app/console doctrine:fixtures:load -n --env=test

script: phpunit -c app/
